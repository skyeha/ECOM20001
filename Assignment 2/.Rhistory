# Load the dataset into the environment and neccessary libraries
library('stargazer')
library('ggplot2')
library('dplyr')
library('AER')
# Load the dataset firstly
setwd("D:/Semester 2 2022/ECOM20001/Assignment 2")
sleepData <- read.csv("D:/Semester 2 2022/ECOM20001/Assignment 2/as2_sleep.csv")
View(sleepData) # View dataset
dim(sleepData) # get number of observations and variables
# Question 1: Summary statistic for the dataset.
sleepStat = stargazer(sleepData,
summary.stat = c('n', 'mean', 'sd', 'median', 'min', 'max'),
type = 'text', title = 'Descriptive Statistic for Beer Dataset',
out = 'sleepStat.png')
# Question 2: Constructing scatter plots
#sleep vs educ
scatPlot1 = ggplot(sleepData, aes(educ, sleep)) + geom_point(colour = 'orange') +
labs(title = "Scatter Plot for Sleep Against Education",
y = "Sleep duration (minutes/week)",
x = "Education attainment (years)") +
theme_bw() +
theme(plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
axis.title = element_text(face = "italic", size = 10)) +
geom_smooth(method = lm, se = FALSE, colour = "blue")
scatPlot1
# sleep vs age
scatPlot2 = ggplot(sleepData, aes(age, sleep)) + geom_point(colour = 'orange') +
labs(title = "Scatter Plot for Sleep Against Age",
y = "Sleep duration (minutes/week)",
x = "Age (years)") +
theme_bw() +
theme(plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
axis.title = element_text(face = "italic", size = 10)) +
geom_smooth(method = lm, se = FALSE, colour = "blue")
scatPlot2
# educ vs age
scatPlot3 = ggplot(sleepData, aes(age, educ)) + geom_point(colour = 'orange') +
labs(title = "Scatter Plot for Years of Education Attainment Against Age",
y = "Education attainment (years)",
x = "Age (years)") +
theme_bw() +
theme(plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
axis.title = element_text(face = "italic", size = 10)) +
geom_smooth(method = lm, se = FALSE, colour = "blue")
scatPlot3
#Question 3:
# Sign for sleep against educ: -
# Sign for age and educ : -
# Direction of bias = sign(-) x sign(-) = +
# The coefficient is larger than the actual value since there is a position bias?
# Question 4:
#Reg 1: sleep ~ educ
reg1 = lm(sleep~educ, sleepData)
cov1 = vcovHC(reg1, type = "HC1") # accounting for heteroskedasticity
se1 = sqrt(diag(cov1))
#Reg 2: sleep ~ educ + age
reg2 = lm(sleep~educ + age, sleepData)
cov2 = vcovHC(reg2, type = "HC1");
se2 = sqrt(diag(cov2))
#Reg 3: sleep ~ educ + age + gdhlth
reg3 = lm (sleep~educ + age + gdhlth, sleepData)
cov3 = vcovHC(reg3, type = "HC1")
se3 = sqrt(diag(cov3))
#Reg 4: sleep ~ educ + age + gdhlth + smsa + union + selfe
reg4 = lm(sleep~educ + age + gdhlth + smsa + union + selfe, sleepData)
cov4 = vcovHC(reg4, type = "HC1")
se4 = sqrt(diag(cov4))
#Reg 5: sleep ~ educ + age + gdhlth + smsa + union + selfe + marr + yrsmarr + yngkid
reg5 = lm(sleep~educ + age + gdhlth + smsa + union + selfe + marr + yrsmarr + yngkid, sleepData)
cov5 = vcovHC(reg5, type = "HC1")
se5 = sqrt(diag(cov5))
# Build the regression model
stargazer(reg1, reg2, reg3, reg4, reg5, type="text",
se=list(se1, se2, se3, se4, se5),
digits=2,
dep.var.labels=c("Number of minutes sleep per week"),
covariate.labels=
c("Number of years of education attainment",
"Age",
"Self-reported Health",
"Live in US urban area",
"Part of a union",
"Self-employed",
"Marrital status",
"Number of years Married",
"Have children that is less than 3 years old"),
out="q4_output.txt")
tStat5B = (-11.90 - 0)/5.77
pValue = 2 * pnorm(-abs(tStat5B))
pValue
coefDiff5C = -11.90 - (-9.95)
seDiff5C = sqrt((5.77**2 + 5.84**2))
tStat5C = (coefDiff5C - 0)/seDiff5C
pValue5C = 2 * pnorm(-abs(tStat5C))
pValue5C
seDiff5C
